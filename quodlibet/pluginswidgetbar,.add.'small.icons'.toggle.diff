From 8a6544ca4870478ec57967c6446f3b524e45dffe Mon Sep 17 00:00:00 2001
From: Pete Beardmore <pete.beardmore@msn.com>
Date: Wed, 23 Aug 2017 07:25:22 +0100
Subject: pluginswidgetbar, add 'small icons' toggle

---
 quodlibet/quodlibet/ext/ui/plugins_widgetbar.py | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/quodlibet/quodlibet/ext/ui/plugins_widgetbar.py b/quodlibet/quodlibet/ext/ui/plugins_widgetbar.py
index e9b2196..13f424c 100644
--- a/quodlibet/quodlibet/ext/ui/plugins_widgetbar.py
+++ b/quodlibet/quodlibet/ext/ui/plugins_widgetbar.py
@@ -48,6 +48,7 @@ class Config(object):
     sort_order = ConfProp(_config, "sort_order", "")
     enabled_only = BoolConfProp(_config, "enabled_only", True)
     show_labels = BoolConfProp(_config, "show_labels", True)
+    small_icons = BoolConfProp(_config, "small_icons", False)
 
 
 CONFIG = Config()
@@ -441,8 +442,11 @@ class PluginsWidgetBarPlugin(UserInterfacePlugin, EventPlugin):
             plugin_box_align = Align(left=4, right=4)
             plugin_box_align.add(plugin_box_inner)
 
+            icon_size = Gtk.IconSize.SMALL_TOOLBAR \
+                            if CONFIG.small_icons \
+                            else Gtk.IconSize.LARGE_TOOLBAR
             plugin_icon_image = Gtk.Image.new_from_icon_name(
-                p.icon or Icons.SYSTEM_RUN, Gtk.IconSize.LARGE_TOOLBAR)
+                p.icon or Icons.SYSTEM_RUN, icon_size)
             plugin_icon_image.set_tooltip_markup(
                 _("name: " + p.name + "\nid: " + p.id))
             padding = 10 if CONFIG.show_labels else 5
@@ -564,6 +568,8 @@ class PluginsWidgetBarPlugin(UserInterfacePlugin, EventPlugin):
              None, True, lambda w: self.__update_plugins(), 0),
             (plugin_id + '_show_labels', _("Show labels"),
              None, True, lambda w: self.__update_plugins(), 0),
+            (plugin_id + '_small_icons', _("Use small icons"),
+             None, True, lambda w: self.__update_plugins(), 0),
         ]
         for key, label, tooltip, default, changed_cb, indent in toggles:
             ccb = ConfigCheckButton(label, 'plugins', key,
-- 
1.8.4

